pch = 19)
print(12+14)
svd1 <- svd(scale(dataMatrixOrdered))
pca1 <- prcomp(dataMatrixOrdered, scale = TRUE)
plot(pca1$rotation[, 1], svd1$v[, 1], pch = 19, xlab = "Principal Component 1",
ylab = "Right Singular Vector 1")
abline(c(0, 1))
```
---
title: "Input$Output_Data_Analysis"
author: "Rahul V.V"
date: "22/01/2015"
output: html_document
---
mRNA data analysis
```{r}
par(mar = rep(0.2, 4))
myData = matrix(NA, nrow = 181, ncol = 121)
dataMatrix1 <- read.csv('~/Dropbox/winther/Data/mRNA_pathway-31Jan2014.csv', header = FALSE)
dataMatrix1  = dataMatrix1[-1:-2,-1]
rownames(dataMatrix1) = 1:121
dataMatrix2 = as.matrix(dataMatrix1)
DATAMATRIX <- matrix(dataMatrix2, ncol = ncol(dataMatrix2), dimnames = NULL)
DATAMATRIX = matrix(as.numeric(DATAMATRIX), nrow = nrow(DATAMATRIX), ncol = ncol(DATAMATRIX))
image(1:181, 1:121, t(DATAMATRIX)[, nrow(DATAMATRIX):1])
dataMatrix = DATAMATRIX
par(mar = rep(0.2, 4))
image(1:181, 1:121, t(dataMatrix)[, nrow(dataMatrix):1])
par(mar = rep(0.2, 4))
heatmap(dataMatrix)
hh <- hclust(dist(dataMatrix))
dataMatrixOrdered <- dataMatrix[hh$order, ]
par(mfrow = c(1, 3))
image(t(dataMatrixOrdered)[, nrow(dataMatrixOrdered):1])
plot(rowMeans(dataMatrixOrdered), 121:1, , xlab = "Row Mean", ylab = "Row", pch = 19)
plot(colMeans(dataMatrixOrdered), xlab = "Column", ylab = "Column Mean", pch = 19)
svd1 <- svd(scale(dataMatrixOrdered))
par(mfrow = c(1, 3))
image(t(dataMatrixOrdered)[, nrow(dataMatrixOrdered):1])
plot(svd1$u[, 1], 121:1, , xlab = "Row", ylab = "First left singular vector",
pch = 19)
plot(svd1$v[, 1], xlab = "Column", ylab = "First right singular vector", pch = 19)
par(mfrow = c(1, 2))
plot(svd1$d, xlab = "Column", ylab = "Singular value", pch = 19)
plot(svd1$d^2/sum(svd1$d^2), xlab = "Column", ylab = "Prop. of variance explained",
pch = 19)
print(12+14)
svd1 <- svd(scale(dataMatrixOrdered))
pca1 <- prcomp(dataMatrixOrdered, scale = TRUE)
plot(pca1$rotation[, 1], svd1$v[, 1], pch = 19, xlab = "Principal Component 1",
ylab = "Right Singular Vector 1")
abline(c(0, 1))
plot(pca1$rotation[,1], pca1$rotation[,3], xlab = "Principal Component 1",
ylab = "Principal Component 3")
```
score_analysis <- function(DATAMATRIX, rowsize, colsize){
par(mar = rep(0.2, 4))
myData = matrix(NA, nrow = 181, ncol = 121)
image(1:181, 1:121, t(DATAMATRIX)[, nrow(DATAMATRIX):1])
dataMatrix = DATAMATRIX
par(mar = rep(0.2, 4))
image(1:183, 1:121, t(dataMatrix)[, nrow(dataMatrix):1])
par(mar = rep(0.2, 4))
heatmap(dataMatrix)
hh <- hclust(dist(dataMatrix))
dataMatrixOrdered <- dataMatrix[hh$order, ]
par(mfrow = c(1, 3))
image(t(dataMatrixOrdered)[, nrow(dataMatrixOrdered):1])
plot(rowMeans(dataMatrixOrdered), 121:1, , xlab = "Row Mean", ylab = "Row", pch = 19)
plot(colMeans(dataMatrixOrdered), xlab = "Column", ylab = "Column Mean", pch = 19)
svd1 <- svd(scale(dataMatrixOrdered))
par(mfrow = c(1, 3))
image(t(dataMatrixOrdered)[, nrow(dataMatrixOrdered):1])
plot(svd1$u[, 1], 121:1, , xlab = "Row", ylab = "First left singular vector",
pch = 19)
plot(svd1$v[, 1], xlab = "Column", ylab = "First right singular vector", pch = 19)
par(mfrow = c(1, 2))
plot(svd1$d, xlab = "Column", ylab = "Singular value", pch = 19)
plot(svd1$d^2/sum(svd1$d^2), xlab = "Column", ylab = "Prop. of variance explained",
pch = 19)
svd1 <- svd(scale(dataMatrixOrdered))
pca1 <- prcomp(dataMatrixOrdered, scale = TRUE)
plot(pca1$rotation[, 1], svd1$v[, 1], pch = 19, xlab = "Principal Component 1",
ylab = "Right Singular Vector 1")
abline(c(0, 1))
plot(pca1$rotation[,1], pca1$rotation[,3], xlab = "Principal Component 1",
ylab = "Principal Component 3")
}
############# Main ######################
mRNA <- read.csv('~/Dropbox/winther/Data/mRNA_pathway-31Jan2014.csv', header = FALSE)
mRNA  = mRNA[-1:-2,-1]
rownames(mRNA) = 1:121
dataMatrix2 = as.matrix(mRNA)
DATAMATRIX <- matrix(dataMatrix2, ncol = ncol(dataMatrix2), dimnames = NULL)
DATAMATRIX = matrix(as.numeric(DATAMATRIX), nrow = nrow(DATAMATRIX), ncol = ncol(DATAMATRIX))
score_analysis <- function(DATAMATRIX, rowsize, colsize){
par(mar = rep(0.2, 4))
myData = matrix(NA, nrow = 181, ncol = 121)
image(1:rowsize, 1:colsize, t(DATAMATRIX)[, nrow(DATAMATRIX):1])
dataMatrix = DATAMATRIX
par(mar = rep(0.2, 4))
image(1:rowsize, 1:colsize, t(dataMatrix)[, nrow(dataMatrix):1])
par(mar = rep(0.2, 4))
heatmap(dataMatrix)
hh <- hclust(dist(dataMatrix))
dataMatrixOrdered <- dataMatrix[hh$order, ]
par(mfrow = c(1, 3))
image(t(dataMatrixOrdered)[, nrow(dataMatrixOrdered):1])
plot(rowMeans(dataMatrixOrdered), 121:1, , xlab = "Row Mean", ylab = "Row", pch = 19)
plot(colMeans(dataMatrixOrdered), xlab = "Column", ylab = "Column Mean", pch = 19)
svd1 <- svd(scale(dataMatrixOrdered))
par(mfrow = c(1, 3))
image(t(dataMatrixOrdered)[, nrow(dataMatrixOrdered):1])
plot(svd1$u[, 1], 121:1, , xlab = "Row", ylab = "First left singular vector",
pch = 19)
plot(svd1$v[, 1], xlab = "Column", ylab = "First right singular vector", pch = 19)
par(mfrow = c(1, 2))
plot(svd1$d, xlab = "Column", ylab = "Singular value", pch = 19)
plot(svd1$d^2/sum(svd1$d^2), xlab = "Column", ylab = "Prop. of variance explained",
pch = 19)
svd1 <- svd(scale(dataMatrixOrdered))
pca1 <- prcomp(dataMatrixOrdered, scale = TRUE)
plot(pca1$rotation[, 1], svd1$v[, 1], pch = 19, xlab = "Principal Component 1",
ylab = "Right Singular Vector 1")
abline(c(0, 1))
plot(pca1$rotation[,1], pca1$rotation[,3], xlab = "Principal Component 1",
ylab = "Principal Component 3")
}
############# Main ######################
mRNA <- read.csv('~/Dropbox/winther/Data/mRNA_pathway-31Jan2014.csv', header = FALSE)
rowsize = 183
colsize = 121
mRNA  = mRNA[-1:-2,-1]
rownames(mRNA) = 1:121
dataMatrix2 = as.matrix(mRNA)
DATAMATRIX <- matrix(dataMatrix2, ncol = ncol(dataMatrix2), dimnames = NULL)
DATAMATRIX = matrix(as.numeric(DATAMATRIX), nrow = nrow(DATAMATRIX), ncol = ncol(DATAMATRIX))
score_analysis(DATAMATRIX, rowsize, colsize)
nrow(DATAMATRIX)
ncol(DATAMATRIX)
ncol(dataMatrix2)
nrow(dataMatrix2)
mRNA <- read.csv('~/Dropbox/winther/Data/mRNA_pathway-31Jan2014.csv', header = FALSE)
rowsize = 183
colsize = 121
mRNA  = mRNA[-1:-2,-1]
rownames(mRNA) = 1:121
dataMatrix2 = as.matrix(mRNA)
DATAMATRIX <- matrix(dataMatrix2, ncol = ncol(dataMatrix2), dimnames = NULL)
DATAMATRIX = matrix(as.numeric(DATAMATRIX), nrow = nrow(DATAMATRIX), ncol = ncol(DATAMATRIX))
ncol(dataMatrix2)
ncol(mRNA)
score_analysis <- function(DATAMATRIX, rowsize, colsize){
par(mar = rep(0.2, 4))
myData = matrix(NA, nrow = 181, ncol = 121)
image(1:rowsize, 1:colsize, t(DATAMATRIX)[, nrow(DATAMATRIX):1])
dataMatrix = DATAMATRIX
par(mar = rep(0.2, 4))
image(1:rowsize, 1:colsize, t(dataMatrix)[, nrow(dataMatrix):1])
par(mar = rep(0.2, 4))
heatmap(dataMatrix)
hh <- hclust(dist(dataMatrix))
dataMatrixOrdered <- dataMatrix[hh$order, ]
par(mfrow = c(1, 3))
image(t(dataMatrixOrdered)[, nrow(dataMatrixOrdered):1])
plot(rowMeans(dataMatrixOrdered), 121:1, , xlab = "Row Mean", ylab = "Row", pch = 19)
plot(colMeans(dataMatrixOrdered), xlab = "Column", ylab = "Column Mean", pch = 19)
svd1 <- svd(scale(dataMatrixOrdered))
par(mfrow = c(1, 3))
image(t(dataMatrixOrdered)[, nrow(dataMatrixOrdered):1])
plot(svd1$u[, 1], 121:1, , xlab = "Row", ylab = "First left singular vector",
pch = 19)
plot(svd1$v[, 1], xlab = "Column", ylab = "First right singular vector", pch = 19)
par(mfrow = c(1, 2))
plot(svd1$d, xlab = "Column", ylab = "Singular value", pch = 19)
plot(svd1$d^2/sum(svd1$d^2), xlab = "Column", ylab = "Prop. of variance explained",
pch = 19)
svd1 <- svd(scale(dataMatrixOrdered))
pca1 <- prcomp(dataMatrixOrdered, scale = TRUE)
plot(pca1$rotation[, 1], svd1$v[, 1], pch = 19, xlab = "Principal Component 1",
ylab = "Right Singular Vector 1")
abline(c(0, 1))
plot(pca1$rotation[,1], pca1$rotation[,3], xlab = "Principal Component 1",
ylab = "Principal Component 3")
}
############# Main ######################
mRNA <- read.csv('~/Dropbox/winther/Data/mRNA_pathway-31Jan2014.csv', header = FALSE)
rowsize = 181
colsize = 121
mRNA  = mRNA[-1:-2,-1]
rownames(mRNA) = 1:121
dataMatrix2 = as.matrix(mRNA)
DATAMATRIX <- matrix(dataMatrix2, ncol = ncol(dataMatrix2), dimnames = NULL)
DATAMATRIX = matrix(as.numeric(DATAMATRIX), nrow = nrow(DATAMATRIX), ncol = ncol(DATAMATRIX))
score_analysis(DATAMATRIX, rowsize, colsize)
image(1:rowsize, 1:colsize, t(DATAMATRIX)[, nrow(DATAMATRIX):1])
image(1:rowsize, 1:colsize, t(dataMatrix)[, nrow(dataMatrix):1])
dataMatrix = DATAMATRIX
image(1:rowsize, 1:colsize, t(dataMatrix)[, nrow(dataMatrix):1])
heatmap(dataMatrix)
image(t(dataMatrixOrdered)[, nrow(dataMatrixOrdered):1])
plot(rowMeans(dataMatrixOrdered), 121:1, , xlab = "Row Mean", ylab = "Row", pch = 19)
plot(colMeans(dataMatrixOrdered), xlab = "Column", ylab = "Column Mean", pch = 19)
hh <- hclust(dist(dataMatrix))
dataMatrixOrdered <- dataMatrix[hh$order, ]
par(mfrow = c(1, 3))
image(t(dataMatrixOrdered)[, nrow(dataMatrixOrdered):1])
plot(rowMeans(dataMatrixOrdered), 121:1, , xlab = "Row Mean", ylab = "Row", pch = 19)
plot(colMeans(dataMatrixOrdered), xlab = "Column", ylab = "Column Mean", pch = 19)
image(t(dataMatrixOrdered)[, nrow(dataMatrixOrdered):1])
plot(svd1$u[, 1], 121:1, , xlab = "Row", ylab = "First left singular vector",
pch = 19)
plot(svd1$v[, 1], xlab = "Column", ylab = "First right singular vector", pch = 19)
svd1 <- svd(scale(dataMatrixOrdered))
par(mfrow = c(1, 3))
image(t(dataMatrixOrdered)[, nrow(dataMatrixOrdered):1])
plot(svd1$u[, 1], 121:1, , xlab = "Row", ylab = "First left singular vector",
pch = 19)
plot(svd1$v[, 1], xlab = "Column", ylab = "First right singular vector", pch = 19)
plot(svd1$d, xlab = "Column", ylab = "Singular value", pch = 19)
plot(svd1$d^2/sum(svd1$d^2), xlab = "Column", ylab = "Prop. of variance explained",
pch = 19)
svd1 <- svd(scale(dataMatrixOrdered))
pca1 <- prcomp(dataMatrixOrdered, scale = TRUE)
plot(pca1$rotation[, 1], svd1$v[, 1], pch = 19, xlab = "Principal Component 1",
ylab = "Right Singular Vector 1")
abline(c(0, 1))
plot(pca1$rotation[,1], pca1$rotation[,3], xlab = "Principal Component 1",
ylab = "Principal Component 3")
score_analysis <- function(DATAMATRIX, rowsize, colsize){
par(mar = rep(0.2, 4))
myData = matrix(NA, nrow = 181, ncol = 121)
image(1:rowsize, 1:colsize, t(DATAMATRIX)[, nrow(DATAMATRIX):1])
dataMatrix = DATAMATRIX
par(mar = rep(0.2, 4))
image(1:rowsize, 1:colsize, t(dataMatrix)[, nrow(dataMatrix):1])
par(mar = rep(0.2, 4))
heatmap(dataMatrix)
hh <- hclust(dist(dataMatrix))
dataMatrixOrdered <- dataMatrix[hh$order, ]
par(mfrow = c(1, 3))
image(t(dataMatrixOrdered)[, nrow(dataMatrixOrdered):1])
plot(rowMeans(dataMatrixOrdered), 121:1, , xlab = "Row Mean", ylab = "Row", pch = 19)
plot(colMeans(dataMatrixOrdered), xlab = "Column", ylab = "Column Mean", pch = 19)
svd1 <- svd(scale(dataMatrixOrdered))
par(mfrow = c(1, 3))
image(t(dataMatrixOrdered)[, nrow(dataMatrixOrdered):1])
plot(svd1$u[, 1], 121:1, , xlab = "Row", ylab = "First left singular vector",
pch = 19)
plot(svd1$v[, 1], xlab = "Column", ylab = "First right singular vector", pch = 19)
par(mfrow = c(1, 2))
plot(svd1$d, xlab = "Column", ylab = "Singular value", pch = 19)
plot(svd1$d^2/sum(svd1$d^2), xlab = "Column", ylab = "Prop. of variance explained",
pch = 19)
svd1 <- svd(scale(dataMatrixOrdered))
pca1 <- prcomp(dataMatrixOrdered, scale = TRUE)
plot(pca1$rotation[, 1], svd1$v[, 1], pch = 19, xlab = "Principal Component 1",
ylab = "Right Singular Vector 1")
abline(c(0, 1))
plot(pca1$rotation[,1], pca1$rotation[,3], xlab = "Principal Component 1",
ylab = "Principal Component 3")
}
############# Main ######################
#mRNA <- read.csv('~/Dropbox/winther/Data/mRNA_pathway-31Jan2014.csv', header = FALSE)
mRNA <- read.csv('~Dropbox/winther/Data/mutations-31Jan2014.csv')
rowsize = 181
colsize = 121
mRNA  = mRNA[-1:-2,-1]
rownames(mRNA) = 1:121
dataMatrix2 = as.matrix(mRNA)
DATAMATRIX <- matrix(dataMatrix2, ncol = ncol(dataMatrix2), dimnames = NULL)
DATAMATRIX = matrix(as.numeric(DATAMATRIX), nrow = nrow(DATAMATRIX), ncol = ncol(DATAMATRIX))
score_analysis(DATAMATRIX, rowsize, colsize)
nrow(dataMatrix2)
ncol(dataMatrix2)
score_analysis <- function(DATAMATRIX, rowsize, colsize){
par(mar = rep(0.2, 4))
myData = matrix(NA, nrow = 181, ncol = 121)
image(1:rowsize, 1:colsize, t(DATAMATRIX)[, nrow(DATAMATRIX):1])
dataMatrix = DATAMATRIX
par(mar = rep(0.2, 4))
image(1:rowsize, 1:colsize, t(dataMatrix)[, nrow(dataMatrix):1])
par(mar = rep(0.2, 4))
heatmap(dataMatrix)
hh <- hclust(dist(dataMatrix))
dataMatrixOrdered <- dataMatrix[hh$order, ]
par(mfrow = c(1, 3))
image(t(dataMatrixOrdered)[, nrow(dataMatrixOrdered):1])
plot(rowMeans(dataMatrixOrdered), 121:1, , xlab = "Row Mean", ylab = "Row", pch = 19)
plot(colMeans(dataMatrixOrdered), xlab = "Column", ylab = "Column Mean", pch = 19)
svd1 <- svd(scale(dataMatrixOrdered))
par(mfrow = c(1, 3))
image(t(dataMatrixOrdered)[, nrow(dataMatrixOrdered):1])
plot(svd1$u[, 1], 121:1, , xlab = "Row", ylab = "First left singular vector",
pch = 19)
plot(svd1$v[, 1], xlab = "Column", ylab = "First right singular vector", pch = 19)
par(mfrow = c(1, 2))
plot(svd1$d, xlab = "Column", ylab = "Singular value", pch = 19)
plot(svd1$d^2/sum(svd1$d^2), xlab = "Column", ylab = "Prop. of variance explained",
pch = 19)
svd1 <- svd(scale(dataMatrixOrdered))
pca1 <- prcomp(dataMatrixOrdered, scale = TRUE)
plot(pca1$rotation[, 1], svd1$v[, 1], pch = 19, xlab = "Principal Component 1",
ylab = "Right Singular Vector 1")
abline(c(0, 1))
plot(pca1$rotation[,1], pca1$rotation[,3], xlab = "Principal Component 1",
ylab = "Principal Component 3")
}
############# Main ######################
#mRNA <- read.csv('~/Dropbox/winther/Data/mRNA_pathway-31Jan2014.csv', header = FALSE)
mRNA <- read.csv('~Dropbox/winther/Data/mir_rev_path-31Jan2014-2.csv')
rowsize = 181
colsize = 121
mRNA  = mRNA[-1:-2,-1]
rownames(mRNA) = 1:121
dataMatrix2 = as.matrix(mRNA)
DATAMATRIX <- matrix(dataMatrix2, ncol = ncol(dataMatrix2), dimnames = NULL)
DATAMATRIX = matrix(as.numeric(DATAMATRIX), nrow = nrow(DATAMATRIX), ncol = ncol(DATAMATRIX))
score_analysis(DATAMATRIX, rowsize, colsize)
nrow(mRNA)
ncol(mRNA
)
mRNA[1:3, 1:3]
mRNA <- read.csv('~Dropbox/winther/Data/mir_rev_path-31Jan2014-2.csv')
r
mRNA[1:3, 1:3]
mRNA <- read.csv('~Dropbox/winther/Data/mir_rev_path-31Jan2014-2.csv')
setwd("~/Dropbox/winther/Data")
mRNA <- read.csv('~Dropbox/winther/Data/mir_rev_path-31Jan2014-2.csv')
mRNA <- read.csv('~Dropbox/winther/Data/mir_rev_path-31Jan2014-2.csv', header = FALSE)
setwd("~/Dropbox/winther/Data")
mRNA <- read.csv('~Dropbox/winther/Data/mir_rev_path-31Jan2014-2.csv', header = FALSE)
mRNA <- read.csv('~Dropbox/winther/Data/mir_rev_path-31jan2014-2.csv', header = FALSE)
mRNA <- read.csv('~Dropbox/winther/Data/mir_rev_path-31Jan2014-2.csv', header = FALSE)
setwd("~/Dropbox/winther/Data")
score_analysis <- function(DATAMATRIX, rowsize, colsize){
par(mar = rep(0.2, 4))
myData = matrix(NA, nrow = 181, ncol = 121)
image(1:rowsize, 1:colsize, t(DATAMATRIX)[, nrow(DATAMATRIX):1])
dataMatrix = DATAMATRIX
par(mar = rep(0.2, 4))
image(1:rowsize, 1:colsize, t(dataMatrix)[, nrow(dataMatrix):1])
par(mar = rep(0.2, 4))
heatmap(dataMatrix)
hh <- hclust(dist(dataMatrix))
dataMatrixOrdered <- dataMatrix[hh$order, ]
par(mfrow = c(1, 3))
image(t(dataMatrixOrdered)[, nrow(dataMatrixOrdered):1])
plot(rowMeans(dataMatrixOrdered), 121:1, , xlab = "Row Mean", ylab = "Row", pch = 19)
plot(colMeans(dataMatrixOrdered), xlab = "Column", ylab = "Column Mean", pch = 19)
svd1 <- svd(scale(dataMatrixOrdered))
par(mfrow = c(1, 3))
image(t(dataMatrixOrdered)[, nrow(dataMatrixOrdered):1])
plot(svd1$u[, 1], 121:1, , xlab = "Row", ylab = "First left singular vector",
pch = 19)
plot(svd1$v[, 1], xlab = "Column", ylab = "First right singular vector", pch = 19)
par(mfrow = c(1, 2))
plot(svd1$d, xlab = "Column", ylab = "Singular value", pch = 19)
plot(svd1$d^2/sum(svd1$d^2), xlab = "Column", ylab = "Prop. of variance explained",
pch = 19)
svd1 <- svd(scale(dataMatrixOrdered))
pca1 <- prcomp(dataMatrixOrdered, scale = TRUE)
plot(pca1$rotation[, 1], svd1$v[, 1], pch = 19, xlab = "Principal Component 1",
ylab = "Right Singular Vector 1")
abline(c(0, 1))
plot(pca1$rotation[,1], pca1$rotation[,3], xlab = "Principal Component 1",
ylab = "Principal Component 3")
}
############# Main ######################
#mRNA <- read.csv('~/Dropbox/winther/Data/mRNA_pathway-31Jan2014.csv', header = FALSE)
mRNA <- read.csv('~Dropbox/winther/Data/mir_rev_path-31Jan2014-2.csv', header = FALSE)
rowsize = 181
colsize = 121
mRNA  = mRNA[-1:-2,-1]
rownames(mRNA) = 1:121
dataMatrix2 = as.matrix(mRNA)
DATAMATRIX <- matrix(dataMatrix2, ncol = ncol(dataMatrix2), dimnames = NULL)
DATAMATRIX = matrix(as.numeric(DATAMATRIX), nrow = nrow(DATAMATRIX), ncol = ncol(DATAMATRIX))
score_analysis(DATAMATRIX, rowsize, colsize)
score_analysis <- function(DATAMATRIX, rowsize, colsize){
par(mar = rep(0.2, 4))
myData = matrix(NA, nrow = 181, ncol = 121)
image(1:rowsize, 1:colsize, t(DATAMATRIX)[, nrow(DATAMATRIX):1])
dataMatrix = DATAMATRIX
par(mar = rep(0.2, 4))
image(1:rowsize, 1:colsize, t(dataMatrix)[, nrow(dataMatrix):1])
par(mar = rep(0.2, 4))
heatmap(dataMatrix)
hh <- hclust(dist(dataMatrix))
dataMatrixOrdered <- dataMatrix[hh$order, ]
par(mfrow = c(1, 3))
image(t(dataMatrixOrdered)[, nrow(dataMatrixOrdered):1])
plot(rowMeans(dataMatrixOrdered), 121:1, , xlab = "Row Mean", ylab = "Row", pch = 19)
plot(colMeans(dataMatrixOrdered), xlab = "Column", ylab = "Column Mean", pch = 19)
svd1 <- svd(scale(dataMatrixOrdered))
par(mfrow = c(1, 3))
image(t(dataMatrixOrdered)[, nrow(dataMatrixOrdered):1])
plot(svd1$u[, 1], 121:1, , xlab = "Row", ylab = "First left singular vector",
pch = 19)
plot(svd1$v[, 1], xlab = "Column", ylab = "First right singular vector", pch = 19)
par(mfrow = c(1, 2))
plot(svd1$d, xlab = "Column", ylab = "Singular value", pch = 19)
plot(svd1$d^2/sum(svd1$d^2), xlab = "Column", ylab = "Prop. of variance explained",
pch = 19)
svd1 <- svd(scale(dataMatrixOrdered))
pca1 <- prcomp(dataMatrixOrdered, scale = TRUE)
plot(pca1$rotation[, 1], svd1$v[, 1], pch = 19, xlab = "Principal Component 1",
ylab = "Right Singular Vector 1")
abline(c(0, 1))
plot(pca1$rotation[,1], pca1$rotation[,3], xlab = "Principal Component 1",
ylab = "Principal Component 3")
}
############# Main ######################
mRNA <- read.csv('~/Dropbox/winther/Data/mRNA_pathway-31Jan2014.csv', header = FALSE)
#mRNA <- read.csv('~Dropbox/winther/Data/mir_rev_path-31Jan2014-2.csv', header = FALSE)
rowsize = 181
colsize = 121
mRNA  = mRNA[-1:-2,-1]
rownames(mRNA) = 1:121
dataMatrix2 = as.matrix(mRNA)
DATAMATRIX <- matrix(dataMatrix2, ncol = ncol(dataMatrix2), dimnames = NULL)
DATAMATRIX = matrix(as.numeric(DATAMATRIX), nrow = nrow(DATAMATRIX), ncol = ncol(DATAMATRIX))
score_analysis(DATAMATRIX, rowsize, colsize)
mRNA <- read.csv('~Dropbox/winther/Data/mir_rev_path-31Jan2014-2.csv', header = FALSE)
mRNA[1:3, 1:3]
nrow(mRNA
)
ncol(mRNA
)
read.csv('~Dropbox/winther/Data/mir_rev_path-31Jan2014-2.csv')
read.csv('~Dropbox/winther/Data/mir_rev_path-31Jan2014-2.csv')
read.csv('~/home/rahul/Dropbox/winther/Data/mir_rev_path-31Jan2014-2.csv')
read.csv('~/home/rahul/Dropbox/winther/Data/mir_rev_path-31Jan2014.csv')
library(iris)
library(database)
library(datasets)
data(iris)
iris
View(iris)
View(iris)
tapply(iris[,4], iris$Species, mean)
tapply(iris[,4], iris$Species, mean)
apply(iris[1:nrow(iris)], 2, mean)
nrow(iris)
apply(iris[1:nrow(iris),], 2, mean)
apply(iris[1:150, ], 2, mean)
apply(iris[1:150, 1:4], 2, mean)
apply(iris[ , 1:4], 2, mean)
data(mtcars)
mtcars
View(mtcars)
?mtcars
mean(mtcars$mpg)
mean(mtcars$mpg, mtcars$cyl)
mean(mtcars$mpg, mtcars$cyl)
split(mtcars, mtcars$cyl)
with(mtcars, tapply(mpg, cyl, mean))
lapply(mtcars, mean)
26.66364-15.10000
with(mtcars, tapply(hp, cyl, mean))
with(mtcars, tapply(cyl,hp, mean))
with(mtcars, tapply(hp, cyl, mean))
82.63636-209.21429
abs(with(mtcars, tapply(hp, cyl, mean)))
abs(2.2-1)
abs(2.2-16)
82.63636-209.21429
ls
debug(ls)
ls
print(ls)
debug(ls)
debug(ls)
debug(ls)
ls()
debug(ls)
ls()
score_analysis <- function(DATAMATRIX, rowsize, colsize){
par(mar = rep(0.2, 4))
myData = matrix(NA, nrow = 181, ncol = 121)
image(1:rowsize, 1:colsize, t(DATAMATRIX)[, nrow(DATAMATRIX):1])
dataMatrix = DATAMATRIX
par(mar = rep(0.2, 4))
image(1:rowsize, 1:colsize, t(dataMatrix)[, nrow(dataMatrix):1])
par(mar = rep(0.2, 4))
heatmap(dataMatrix)
hh <- hclust(dist(dataMatrix))
dataMatrixOrdered <- dataMatrix[hh$order, ]
par(mfrow = c(1, 3))
image(t(dataMatrixOrdered)[, nrow(dataMatrixOrdered):1])
plot(rowMeans(dataMatrixOrdered), 121:1, , xlab = "Row Mean", ylab = "Row", pch = 19)
plot(colMeans(dataMatrixOrdered), xlab = "Column", ylab = "Column Mean", pch = 19)
svd1 <- svd(scale(dataMatrixOrdered))
par(mfrow = c(1, 3))
image(t(dataMatrixOrdered)[, nrow(dataMatrixOrdered):1])
plot(svd1$u[, 1], 121:1, , xlab = "Row", ylab = "First left singular vector",
pch = 19)
plot(svd1$v[, 1], xlab = "Column", ylab = "First right singular vector", pch = 19)
par(mfrow = c(1, 2))
plot(svd1$d, xlab = "Column", ylab = "Singular value", pch = 19)
plot(svd1$d^2/sum(svd1$d^2), xlab = "Column", ylab = "Prop. of variance explained",
pch = 19)
svd1 <- svd(scale(dataMatrixOrdered))
pca1 <- prcomp(dataMatrixOrdered, scale = TRUE)
plot(pca1$rotation[, 1], svd1$v[, 1], pch = 19, xlab = "Principal Component 1",
ylab = "Right Singular Vector 1")
abline(c(0, 1))
plot(pca1$rotation[,1], pca1$rotation[,3], xlab = "Principal Component 1",
ylab = "Principal Component 3")
}
1
2
